<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Blind Test ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°.</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    h1 span {
      font-size: 0.5em;
      color: gray;
    }
    body {
      font-family: sans-serif;
      margin: 20px;
      max-width: 100%;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
      overflow-x: auto;
    }
    table, th, td {
      border: 1px solid #ccc;
      text-align: center;
      padding: 8px;
    }
    th {
      background-color: #f0f0f0;
    }
    input, select, button {
      padding: 8px;
      margin: 5px 2px; /* ‡∏õ‡∏£‡∏±‡∏ö margin ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ */
      width: 100%;
      max-width: 300px;
    }
    canvas {
      margin-top: 30px;
      max-width: 100%;
    }
    .button-container { /* ‡πÄ‡∏û‡∏¥‡πà‡∏° class ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏õ‡∏∏‡πà‡∏° */
      text-align: right;
      margin-bottom: 10px;
    }
    @media (min-width: 600px) {
      input, select, button {
        width: auto;
      }
    }
  </style>
</head>
<body>




  

<form id="hiddenForm" action="https://docs.google.com/forms/d/e/1FAIpQLSeG8voQqTcX8tnHEP1WPiqGS9ClGSLn5amg7jmIGSqL7gKMJw/formResponse" method="POST" target="hidden_iframe" style="display: none;">
    <input type="hidden" name="entry.106976809" id="payloadField">
    <button type="submit">Submit</button>
  </form>

<iframe name="hidden_iframe" style="display:none;"></iframe>




  
  
  <h1>Blind Test ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°+<span>Cr. NaiGolf</span></h1>

<div class="button-container">
  <button onclick="sendToGoogleSheet()" style="background-color: #ccffcc; margin-right: 5px;">üíæ Save to Sheet....</button> 
  <button onclick="resetStoredData()" style="background-color: #ffcccc;">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
  <button onclick="openDrinkConfig()">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</button>
</div>
  
  
  
  <div>
  <label>‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</label><br>
  	<input id="testNameInput" type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö..." /><br>
  
    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö:</label><br>
    <input type="text" id="testerName" placeholder="‡πÄ‡∏ä‡πà‡∏ô a"><br>
    
    <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏° (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≠‡∏ö):</label><br>
    <select id="rank1"><option value="">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1</option></select>
    <select id="rank2"><option value="">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 2</option></select>
    <select id="rank3"><option value="">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 3</option></select><br>

    <button onclick="submitVote()">‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
  </div>

  <h3>‡∏ú‡∏•‡πÇ‡∏´‡∏ß‡∏ï (‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô)</h3>
  <table id="resultsTable">
    <thead>
      <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö</th>
        <th>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1</th>
        <th>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 2</th>
        <th>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 3</th>
      </tr>
    </thead>
    <tbody id="resultsBody"></tbody>
  </table>

  <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1</h3>
  <table id="rank1Summary">
    <thead>
      <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÇ‡∏´‡∏ß‡∏ï</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 2</h3>
  <table id="rank2Summary">
    <thead>
      <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÇ‡∏´‡∏ß‡∏ï</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 3</h3>
  <table id="rank3Summary">
    <thead>
      <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</th>
        <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÇ‡∏´‡∏ß‡∏ï</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <h3>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</h3>
  <table id="summaryTable">
    <thead>
      <tr>
        <th>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</th>
        <th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°</th>
      </tr>
    </thead>
    <tbody id="summaryBody"></tbody>
  </table>
  
  <div id="chartContainer" style="height: 200px; width: 100%; margin-top: 30px; position: relative;">
  <canvas id="resultsChart"></canvas>
</div>



  <script>
    // --- START: ‡πÄ‡∏û‡∏¥‡πà‡∏° defaultDrinks constant ---
    const defaultDrinksList = ["‡πÅ‡∏Å‡πâ‡∏ß1", "‡πÅ‡∏Å‡πâ‡∏ß2", "‡πÅ‡∏Å‡πâ‡∏ß3", "‡πÅ‡∏Å‡πâ‡∏ß4", "‡πÅ‡∏Å‡πâ‡∏ß5", "‡πÅ‡∏Å‡πâ‡∏ß6", "‡πÅ‡∏Å‡πâ‡∏ß7", "‡πÅ‡∏Å‡πâ‡∏ß8"];
    let drinks = [...defaultDrinksList]; // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡πâ drinks
    let votes = [];
    // --- END: ‡πÄ‡∏û‡∏¥‡πà‡∏° defaultDrinks constant ---

    // ‡πÇ‡∏´‡∏•‡∏î drinks ‡∏à‡∏≤‡∏Å localStorage (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
    const storedDrinks = localStorage.getItem('blindTestDrinks');
    if (storedDrinks) {
      try {
        const parsedDrinks = JSON.parse(storedDrinks);
        if (Array.isArray(parsedDrinks) && parsedDrinks.length > 0) { // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô array ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á
            drinks = parsedDrinks;
        } else {
            localStorage.removeItem('blindTestDrinks'); // ‡∏•‡∏ö‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
        }
      } catch (e) {
        console.error("Error parsing stored drinks:", e);
        localStorage.removeItem('blindTestDrinks');
      }
    }

    // ‡πÇ‡∏´‡∏•‡∏î votes ‡∏à‡∏≤‡∏Å localStorage (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
    const storedVotes = localStorage.getItem('blindTestVotes');
    if (storedVotes) {
      try {
        const parsedVotes = JSON.parse(storedVotes);
        if (Array.isArray(parsedVotes)) { // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô array
            votes = parsedVotes;
        } else {
            localStorage.removeItem('blindTestVotes'); // ‡∏•‡∏ö‡∏ñ‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
        }
      } catch (e) {
        console.error("Error parsing stored votes:", e);
        localStorage.removeItem('blindTestVotes');
      }
    }

    function populateDrinkDropdowns() {
      [rank1, rank2, rank3].forEach(select => {
        const firstOptionText = `‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö ${select.id === 'rank1' ? 1 : select.id === 'rank2' ? 2 : 3}`;
        select.innerHTML = `<option value="">${firstOptionText}</option>`; // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ option default

        drinks.forEach(d => {
          const option = document.createElement("option");
          option.value = d;
          option.textContent = d;
          select.appendChild(option);
        });
      });
    }
    populateDrinkDropdowns();

    function submitVote() {
      const name = testerName.value.trim();
      const r1 = rank1.value, r2 = rank2.value, r3 = rank3.value;

      if (!name || !r1) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1");
        return;
      }

      const ranks = [r1, r2, r3].filter(Boolean);

      if (new Set(ranks).size !== ranks.length) {
        alert("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô");
        return;
      }

      votes.push({ name, ranks });
      localStorage.setItem('blindTestVotes', JSON.stringify(votes));

      testerName.value = "";
      [rank1, rank2, rank3].forEach(select => select.selectedIndex = 0);

      updateAllDisplays();
    }

    function updateTable() {
      resultsBody.innerHTML = "";
      votes.forEach(vote => {
        const row = document.createElement("tr");
        row.insertCell().textContent = vote.name;
        row.insertCell().textContent = vote.ranks[0] || "-";
        row.insertCell().textContent = vote.ranks[1] || "-";
        row.insertCell().textContent = vote.ranks[2] || "-";
        resultsBody.appendChild(row);
      });
    }

    function updateSummary() {
      const countMap = {};
      drinks.forEach(d => countMap[d] = 0);
      votes.forEach(vote => {
        vote.ranks.forEach(drink => {
          if (countMap.hasOwnProperty(drink)) {
             countMap[drink]++;
          }
        });
      });

      const sortedSummary = Object.entries(countMap).sort((a, b) => b[1] - a[1]);
      summaryBody.innerHTML = "";
      sortedSummary.forEach(([drink, score]) => {
        const row = summaryBody.insertRow();
        row.insertCell().textContent = drink;
        row.insertCell().textContent = score;
      });
    }

    function updateRankSummary() {
      const rankCounts = [{}, {}, {}];
      drinks.forEach(drink => {
        rankCounts[0][drink] = 0;
        rankCounts[1][drink] = 0;
        rankCounts[2][drink] = 0;
      });

      votes.forEach(vote => {
        vote.ranks.forEach((drink, i) => {
          if (rankCounts[i] && rankCounts[i].hasOwnProperty(drink)) {
             rankCounts[i][drink]++;
          }
        });
      });

      rankCounts.forEach((countMap, i) => {
        const tbody = document.querySelector(`#rank${i + 1}Summary tbody`);
        tbody.innerHTML = "";
        const sorted = Object.entries(countMap).sort((a, b) => b[1] - a[1]);
        sorted.forEach(([drink, count]) => {
          const row = tbody.insertRow();
          row.insertCell().textContent = drink;
          row.insertCell().textContent = count;
        });
      });
    }
    
    let chart;
    function updateChart() {
      const countMap = {};
      drinks.forEach(d => countMap[d] = 0);
      votes.forEach(vote => {
        vote.ranks.forEach(drink => {
          if (countMap.hasOwnProperty(drink)) {
            countMap[drink]++;
          }
        });
      });

      const labels = [...drinks]; // ‡∏™‡∏£‡πâ‡∏≤‡∏á copy ‡∏Ç‡∏≠‡∏á drinks array ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢
      const data = labels.map(d => countMap[d] || 0);

      if (chart) chart.destroy();
      const ctx = document.getElementById("resultsChart").getContext("2d");

      chart = new Chart(ctx, {
        type: "bar",
        data: {
          labels,
          datasets: [{
            label: "‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°",
            data,
            backgroundColor: "rgba(0, 150, 200, 0.6)"
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false, // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô
          scales: {
            y: {
              beginAtZero: true,
              ticks: { precision: 0 }
            }
          },
          plugins: {
            tooltip: { enabled: true },
            legend: { display: false }
          }
        },
        plugins: [{
          id: 'valueOnTop',
          afterDatasetsDraw(chartInstance) {
            const { ctx, data: chartData, chartArea: { top }, scales: { y } } = chartInstance; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠ data ‡πÄ‡∏õ‡πá‡∏ô chartData
            ctx.save();
            chartInstance.getDatasetMeta(0).data.forEach((bar, i) => {
              const val = chartData.datasets[0].data[i];
              if (val > 0) {
                const x = bar.x;
                const yPos = bar.y;
                ctx.fillStyle = "#000";
                ctx.font = "14px sans-serif";
                ctx.textAlign = "center";
                const valueY = yPos - 6;
                const minY = top + 14;
                ctx.fillText(val, x, valueY < minY ? minY : valueY);
              }
            });
            ctx.restore();
          }
        }]
      });
    }

    function openDrinkConfig() {
      const modal = document.getElementById("configModal");
      const overlay = document.getElementById("modalOverlay");
      const container = document.getElementById("drinkInputs");

      container.innerHTML = "";
      drinks.forEach((drink, i) => {
        const label = document.createElement("label");
        label.textContent = `‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏° ${i + 1}:`;
        const input = document.createElement("input");
        input.type = "text";
        input.value = drink;
        input.dataset.index = i;
        input.placeholder = `‡πÄ‡∏ä‡πà‡∏ô ${defaultDrinksList[i] || '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°'}`; // ‡πÉ‡∏ä‡πâ default list ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö placeholder

        container.appendChild(label);
        container.appendChild(document.createElement("br"));
        container.appendChild(input);
        container.appendChild(document.createElement("br"));
      });

      modal.style.display = "block";
      overlay.style.display = "block";
    }

    function closeDrinkConfig() {
      document.getElementById("configModal").style.display = "none";
      document.getElementById("modalOverlay").style.display = "none";
    }

    function saveDrinkConfig() {
      const inputs = document.querySelectorAll("#drinkInputs input");
      const newDrinks = [];
      inputs.forEach(input => {
        const index = parseInt(input.dataset.index);
        // ‡∏ñ‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠ default ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
        const defaultName = defaultDrinksList[index] || `‡πÅ‡∏Å‡πâ‡∏ß${index + 1}`;
        newDrinks[index] = input.value.trim() || drinks[index] || defaultName;
      });
      drinks = newDrinks;

      localStorage.setItem('blindTestDrinks', JSON.stringify(drinks));
      populateDrinkDropdowns();
      updateAllDisplays(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
      closeDrinkConfig();
    }

    // --- START: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô resetStoredData ---
    function resetStoredData() {
      if (confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏ß‡∏ï‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
        localStorage.removeItem('blindTestVotes');
        localStorage.removeItem('blindTestDrinks');

        votes = [];
        drinks = [...defaultDrinksList]; // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï drinks ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô

        testerName.value = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏ô input
        populateDrinkDropdowns(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï dropdowns
        updateAllDisplays(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≤‡∏ü‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

        alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÅ‡∏•‡πâ‡∏ß");
      }
    }
    // --- END: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô resetStoredData ---
    
    
    
    
    
    

    
 
 
 
 function sendToGoogleSheet() {

  const testNameValue = document.getElementById("testNameInput").value.trim(); // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô

  // alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• votes ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á: " + JSON.stringify(votes)); // Debugging: ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• votes ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á

  if (!testNameValue) { // ‡πÉ‡∏ä‡πâ testNameValue ‡∏ó‡∏µ‡πà trim ‡πÅ‡∏•‡πâ‡∏ß
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheet");
    document.getElementById("testNameInput").focus(); // ‡πÉ‡∏´‡πâ focus ‡πÑ‡∏õ‡∏ó‡∏µ‡πà input
    return;
  }

  if (votes.length === 0) {
    alert("‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏ß‡∏ï‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á");
    return;
  }

  // --- START: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç payload ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà Apps Script ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á ---
  const payload = {
    testName: testNameValue,
    drinksConfig: [...drinks], // ‡πÄ‡∏û‡∏¥‡πà‡∏° config ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    votesData: [...votes]      // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô key ‡∏à‡∏≤‡∏Å 'votes' ‡πÄ‡∏õ‡πá‡∏ô 'votesData'
  };
  // --- END: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç payload ---

  console.log("Payload to send to Google Sheet:", JSON.stringify(payload)); // Debugging: ‡πÅ‡∏™‡∏î‡∏á payload ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

  const sendButton = document.querySelector('.button-container button[onclick="sendToGoogleSheet()"]'); // ‡∏´‡∏≤‡∏õ‡∏∏‡πà‡∏° Save to Sheet
  if(sendButton) {
      sendButton.disabled = true;
      sendButton.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...';
  }


      const jsonString = JSON.stringify(payload);
      console.log("‡∏™‡πà‡∏á JSON ‡πÑ‡∏õ Google Forms:", jsonString);

      // ‡πÉ‡∏™‡πà JSON ‡∏•‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á entry
      document.getElementById("payloadField").value = jsonString;

      // ‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ã‡πà‡∏≠‡∏ô
      document.getElementById("hiddenForm").submit();


   
  
}

    
    
    
    
    
    
    
    
    
    

    // --- START: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô updateAllDisplays ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡πÇ‡∏Ñ‡πâ‡∏î‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô ---
    function updateAllDisplays() {
        updateTable();
        updateSummary();
        updateRankSummary();
        updateChart();
    }
    // --- END: ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô updateAllDisplays ---

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°
    updateAllDisplays();

  </script>

  <div id="configModal" style="display:none; position:fixed; top:10%; left:50%; transform:translateX(-50%); background:#fff; border:1px solid #ccc; padding:20px; z-index:1000; max-width:90%; box-shadow: 0 2px 10px rgba(0,0,0,0.2);">
    <h3>‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°</h3>
    <div id="drinkInputs"></div>
    <button onclick="saveDrinkConfig()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
    <button onclick="closeDrinkConfig()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
  </div>
  <div id="modalOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.2); z-index:999;" onclick="closeDrinkConfig()"></div>

</body>
</html>
